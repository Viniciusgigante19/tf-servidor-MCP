import{j as e}from"./app.js";import{r as l}from"./index.js";import{f as x,a as h,B as p,p as g,P as j}from"./Button.js";import{b,c as w}from"./catchError.js";import"./index2.js";function N({products:s,onDelete:a}){var d;const[t,c]=l.useState(s??{rows:[],count:0,limit:10,page:1,next:null,totalPages:0}),i=l.useRef(new Map),o=l.useCallback(r=>n=>{if(n){i.current.set(r,n);return}i.current.delete(r)},[]);l.useEffect(()=>{s&&c(s)},[s]),console.log("DATA RECEBIDA",t);const f=r=>async()=>{var m,u;if((m=i.current.get(r))==null||m.disable(),await g(r)!==null){(u=i.current.get(r))==null||u.enable();return}a==null||a()};return t?t==="error"?e.jsx("div",{className:"alert alert-warning",children:"Erro na API."}):e.jsx("div",{children:((d=t.rows)==null?void 0:d.length)===0?e.jsx("div",{className:"alert alert-warning",children:"Nenhum produto encontrado."}):e.jsx("div",{className:"row row-cols-1 row-cols-md-2 g-4",children:t.rows.map(r=>{const n=r.id;return e.jsx("div",{className:"col",children:e.jsxs("div",{className:"card h-100 border-0 shadow-sm rounded-4",children:[e.jsxs("div",{className:"card-body d-flex flex-column",children:[e.jsxs("div",{className:"d-flex justify-content-between align-items-start mb-2",children:[e.jsx("h6",{className:"card-title mb-0 fw-semibold",children:r.name}),e.jsx("span",{className:"badge text-bg-light border",children:x(r.price_times_thousand)})]}),e.jsxs("p",{className:"card-text text-muted small mt-2 mb-0",children:[e.jsx("i",{className:"fa-regular fa-clock me-1","aria-hidden":"true"}),"Cadastrado em ",h(r.created_at)]})]}),e.jsx("div",{className:"card-footer bg-white border-0 pt-0",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("span",{className:"badge rounded-pill text-bg-primary",children:["#",r.id]}),e.jsx(p,{ref:o(n),onClick:f(n),classList:"btn-danger",children:e.jsx("i",{className:"fa-solid fa-trash"})},n)]})})]})},n)})})}):e.jsxs("div",{className:"alert alert-light border d-flex align-items-center gap-2",children:[e.jsx("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}),"Carregando produtos..."]})}async function P(s=15,a="id,desc"){const t=new URLSearchParams({orderBy:a,limit:s.toString()});try{const{data:c}=await b.get(`api/products?${t}`);return c}catch(c){return w(c)}}function B(){const[s,a]=l.useState({rows:[],count:0,limit:10,page:1,next:null,totalPages:0});l.useEffect(()=>{t()},[]);const t=async()=>{const o=await P(10);if("error"in o)return a("error");a(o)},c=()=>{t()},i=()=>{t()};return e.jsxs("div",{className:"row g-4",children:[e.jsx(j,{onCreate:c}),e.jsx(N,{products:s,onDelete:i})]})}export{B as default};
